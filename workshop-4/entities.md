# üß© Entities ‚Äî LBK Points System

### 1. **USERS**

**‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:** ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏£‡∏∞‡∏ö‡∏ö
**Fields ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç:**

* `id` (PK) ‚Äî ‡∏£‡∏´‡∏±‡∏™‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
* `first_name`, `last_name` ‚Äî ‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•
* `phone`, `email (UK)` ‚Äî ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ (email ‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥)
* `member_since`, `membership_level` ‚Äî ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å
* `points` ‚Äî ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
* `created_at`, `updated_at` ‚Äî ‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç

---

### 2. **TRANSFERS**

**‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:** ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô‡πÅ‡∏ï‡πâ‡∏°‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ

**Fields ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç:**
* `id` (PK) ‚Äî ‡∏£‡∏´‡∏±‡∏™‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô
* `from_user_id (FK)` ‚Äî ‡∏ú‡∏π‡πâ‡πÇ‡∏≠‡∏ô
* `to_user_id (FK)` ‚Äî ‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö
* `amount` ‚Äî ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏ï‡πâ‡∏°
* `status` ‚Äî ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ (`pending`, `completed`, `failed`, etc.)
* `note` ‚Äî ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°
* `idempotency_key (UK)` ‚Äî ‡πÉ‡∏ä‡πâ‡∏Å‡∏±‡∏ô‡∏ã‡πâ‡∏≥‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡πÇ‡∏≠‡∏ô
* `created_at`, `updated_at`, `completed_at` ‚Äî ‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á
* `fail_reason` ‚Äî ‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡∏´‡∏≤‡∏Å‡πÇ‡∏≠‡∏ô‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß

**Relations:**

* USERS (as sender) ‚Üí TRANSFERS
* USERS (as receiver) ‚Üí TRANSFERS

---

### 3. **POINT_LEDGER**

**‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:** ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡πÅ‡∏ï‡πâ‡∏°‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ (Transaction History)
**Fields ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç:**

* `id` (PK) ‚Äî ‡∏£‡∏´‡∏±‡∏™‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
* `user_id (FK)` ‚Äî ‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πâ‡∏°
* `change` ‚Äî ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏ï‡πâ‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô (+/-)
* `balance_after` ‚Äî ‡πÅ‡∏ï‡πâ‡∏°‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏´‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô
* `event_type` ‚Äî ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå (`earn`, `spend`, `transfer_in`, `transfer_out`, etc.)
* `transfer_id (FK)` ‚Äî ‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô‡∏ñ‡πâ‡∏≤‡∏°‡∏µ
* `reference`, `metadata` ‚Äî ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°
* `created_at` ‚Äî ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å

**Relations:**

* USERS ‚Üí POINT_LEDGER
* TRANSFERS ‚Üí POINT_LEDGER

---

### üîó ‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î

| Entity    | ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå                                                  |
| --------- | ------------------------------------------------------------- |
| USERS     | 1 ‚Üí N ‡∏Å‡∏±‡∏ö TRANSFERS (‡∏ó‡∏±‡πâ‡∏á‡∏à‡∏≤‡∏Å `from_user_id` ‡πÅ‡∏•‡∏∞ `to_user_id`) |
| USERS     | 1 ‚Üí N ‡∏Å‡∏±‡∏ö POINT_LEDGER                                        |
| TRANSFERS | 1 ‚Üí N ‡∏Å‡∏±‡∏ö POINT_LEDGER                                        |

---

**‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏°‡∏µ 3 Entities:**
`USERS`, `TRANSFERS`, ‡πÅ‡∏•‡∏∞ `POINT_LEDGER` ‚úÖ
